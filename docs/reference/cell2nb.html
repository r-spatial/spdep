<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate neighbours list for grid cells — cell2nb • spdep</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate neighbours list for grid cells — cell2nb" />
<meta property="og:description" content="The function generates a list of neighbours for a grid of cells. Helper
functions are used to convert to and from the vector indices for row and 
column grid positions, and rook (shared edge) or queen (shared edge or 
vertex) neighbour definitions are applied by type. If torus is TRUE, the 
grid is mapped onto a torus, removing edge effects." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate neighbours list for grid cells</h1>
    
    <div class="hidden name"><code>cell2nb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function generates a list of neighbours for a grid of cells. Helper
functions are used to convert to and from the vector indices for row and 
column grid positions, and rook (shared edge) or queen (shared edge or 
vertex) neighbour definitions are applied by type. If torus is TRUE, the 
grid is mapped onto a torus, removing edge effects.</p>
    </div>

    <pre class="usage"><span class='fu'>cell2nb</span><span class='op'>(</span><span class='va'>nrow</span>, <span class='va'>ncol</span>, type<span class='op'>=</span><span class='st'>"rook"</span>, torus<span class='op'>=</span><span class='cn'>FALSE</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span>, x<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'>vi2mrc</span><span class='op'>(</span><span class='va'>i</span>, <span class='va'>nrow</span>, <span class='va'>ncol</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nrow</th>
      <td><p>number of rows in the grid, may also be an object inheriting from class <code>"SpatialGrid"</code> or <code>"GridTopology"</code> only in <code>cell2nb</code></p></td>
    </tr>
    <tr>
      <th>ncol</th>
      <td><p>number of columns in the grid; if <code>nrow</code> or <code>x</code> is an object inheriting from class <code>"SpatialGrid"</code> or <code>"GridTopology"</code>, it may be omitted</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>default rook, may also be queen</p></td>
    </tr>
    <tr>
      <th>torus</th>
      <td><p>default FALSE, if TRUE map grid onto torus</p></td>
    </tr>
    <tr>
      <th>legacy</th>
      <td><p>default FALSE, nrow/ncol reversed, if TRUE wrong col/row directions (see <a href='https://github.com/r-spatial/spdep/issues/20'>https://github.com/r-spatial/spdep/issues/20</a>)</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>if given, an object inheriting from class <code>"SpatialGrid"</code> or <code>"GridTopology"</code>, and replaces <code>nrow</code> and <code>ncol</code></p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>vector of vector indices corresponding to rowcol, a matrix with two columns of row, column indices</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an object of class <code>nb</code> with a list of integer vectors containing neighbour region number ids. See <code><a href='card.html'>card</a></code> for details of &#8220;nb&#8221; objects.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.nb.html'>summary.nb</a></code>, <code><a href='card.html'>card</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>nb7rt</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>7</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nb7rt</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 168 
#&gt; Percentage nonzero weights: 6.997085 
#&gt; Average number of links: 3.428571 
#&gt; Link number distribution:
#&gt; 
#&gt;  2  3  4 
#&gt;  4 20 25 
#&gt; 4 least connected regions:
#&gt; 1:1 7:1 1:7 7:7 with 2 links
#&gt; 25 most connected regions:
#&gt; 2:2 3:2 4:2 5:2 6:2 2:3 3:3 4:3 5:3 6:3 2:4 3:4 4:4 5:4 6:4 2:5 3:5 4:5 5:5 6:5 2:6 3:6 4:6 5:6 6:6 with 4 links</div><div class='input'><span class='va'>xyc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>nb7rt</span>, <span class='st'>"region.id"</span><span class='op'>)</span>
<span class='va'>xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span><span class='op'>(</span><span class='va'>xyc</span>, <span class='st'>":"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>2</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>nb7rt</span>, <span class='va'>xy</span><span class='op'>)</span>
</div><div class='img'><img src='cell2nb-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>nb7rt</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>7</span>, torus<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nb7rt</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Neighbour list object:
#&gt; Number of regions: 49 
#&gt; Number of nonzero links: 196 
#&gt; Percentage nonzero weights: 8.163265 
#&gt; Average number of links: 4 
#&gt; Link number distribution:
#&gt; 
#&gt;  4 
#&gt; 49 
#&gt; 49 least connected regions:
#&gt; 1:1 2:1 3:1 4:1 5:1 6:1 7:1 1:2 2:2 3:2 4:2 5:2 6:2 7:2 1:3 2:3 3:3 4:3 5:3 6:3 7:3 1:4 2:4 3:4 4:4 5:4 6:4 7:4 1:5 2:5 3:5 4:5 5:5 6:5 7:5 1:6 2:6 3:6 4:6 5:6 6:6 7:6 1:7 2:7 3:7 4:7 5:7 6:7 7:7 with 4 links
#&gt; 49 most connected regions:
#&gt; 1:1 2:1 3:1 4:1 5:1 6:1 7:1 1:2 2:2 3:2 4:2 5:2 6:2 7:2 1:3 2:3 3:3 4:3 5:3 6:3 7:3 1:4 2:4 3:4 4:4 5:4 6:4 7:4 1:5 2:5 3:5 4:5 5:5 6:5 7:5 1:6 2:6 3:6 4:6 5:6 6:6 7:6 1:7 2:7 3:7 4:7 5:7 6:7 7:7 with 4 links</div><div class='input'><span class='co'># https://github.com/r-spatial/spdep/issues/20</span>
<span class='va'>GT</span> <span class='op'>&lt;-</span> <span class='fu'>GridTopology</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>SPix</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>SpatialGrid</span><span class='op'>(</span><span class='va'>GT</span><span class='op'>)</span>, <span class='st'>"SpatialPixels"</span><span class='op'>)</span>
<span class='va'>nb_rook_cont</span> <span class='op'>&lt;-</span> <span class='fu'><a href='poly2nb.html'>poly2nb</a></span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>SPix</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>, queen<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nb_rook_dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dnearneigh.html'>dnearneigh</a></span><span class='op'>(</span><span class='fu'>coordinates</span><span class='op'>(</span><span class='va'>SPix</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>1.01</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>nb_rook_dist</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'>## [1] TRUE</span>
<span class='va'>t.nb</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='va'>GT</span>, type<span class='op'>=</span><span class='st'>'rook'</span>, legacy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>t.nb</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='co'>## [1] FALSE</span>
<span class='va'>t.nb</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='va'>GT</span>, type<span class='op'>=</span><span class='st'>'rook'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>t.nb</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'>## [1] TRUE</span>
<span class='co'># https://github.com/r-spatial/spdep/issues/55</span>
<span class='co'># problem reported in issue caused by rep() cycling in unexpected order</span>
<span class='va'>GT</span> <span class='op'>&lt;-</span> <span class='fu'>GridTopology</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>22</span>, <span class='fl'>11</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>SPix</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='fu'>SpatialGrid</span><span class='op'>(</span><span class='va'>GT</span><span class='op'>)</span>, <span class='st'>"SpatialPixels"</span><span class='op'>)</span>
<span class='va'>nb_rook_cont</span> <span class='op'>&lt;-</span> <span class='fu'><a href='poly2nb.html'>poly2nb</a></span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>SPix</span>, <span class='st'>"SpatialPolygons"</span><span class='op'>)</span>, queen<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>nb_rook_dist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dnearneigh.html'>dnearneigh</a></span><span class='op'>(</span><span class='fu'>coordinates</span><span class='op'>(</span><span class='va'>SPix</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='fl'>1.01</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>nb_rook_dist</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>t.nb</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='va'>GT</span>, type<span class='op'>=</span><span class='st'>'rook'</span>, legacy<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>t.nb</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='co'>## [1] FALSE</span>
<span class='va'>t.nb</span> <span class='op'>&lt;-</span> <span class='fu'>cell2nb</span><span class='op'>(</span><span class='va'>GT</span>, type<span class='op'>=</span><span class='st'>'rook'</span>, legacy<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>nb_rook_cont</span>, <span class='va'>t.nb</span>, check.attributes<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='co'>## [1] TRUE</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


