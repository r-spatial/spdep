<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rao's score (a.k.a Lagrange Multiplier) diagnostics for spatial dependence in linear models — lm.LMtests • spdep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rao's score (a.k.a Lagrange Multiplier) diagnostics for spatial dependence in linear models — lm.LMtests"><meta name="description" content="The function reports the estimates of tests chosen among five statistics for
testing for spatial dependence in linear models. The statistics are
the simple RS test for error dependence (&amp;#8220;RSerr&amp;#8221;), the simple RS test
for a missing spatially lagged dependent variable (&amp;#8220;RSlag&amp;#8221;), variants
of these adjusted for the presence of the other (&amp;#8220;adjRSerr&amp;#8221;
tests for error dependence in the possible presence of a missing lagged
dependent variable, &amp;#8220;adjRSlag&amp;#8221; the other way round), and a portmanteau test
(&amp;#8220;SARMA&amp;#8221;, in fact &amp;#8220;RSerr&amp;#8221; + &amp;#8220;adjRSlag&amp;#8221;). Note: from spdep 1.3-2, the tests are re-named &amp;#8220;RS&amp;#8221; - Rao's score tests, rather than &amp;#8220;LM&amp;#8221; - Lagrange multiplier tests to match the naming of tests from the same family in SDM.RStests."><meta property="og:description" content="The function reports the estimates of tests chosen among five statistics for
testing for spatial dependence in linear models. The statistics are
the simple RS test for error dependence (&amp;#8220;RSerr&amp;#8221;), the simple RS test
for a missing spatially lagged dependent variable (&amp;#8220;RSlag&amp;#8221;), variants
of these adjusted for the presence of the other (&amp;#8220;adjRSerr&amp;#8221;
tests for error dependence in the possible presence of a missing lagged
dependent variable, &amp;#8220;adjRSlag&amp;#8221; the other way round), and a portmanteau test
(&amp;#8220;SARMA&amp;#8221;, in fact &amp;#8220;RSerr&amp;#8221; + &amp;#8220;adjRSlag&amp;#8221;). Note: from spdep 1.3-2, the tests are re-named &amp;#8220;RS&amp;#8221; - Rao's score tests, rather than &amp;#8220;LM&amp;#8221; - Lagrange multiplier tests to match the naming of tests from the same family in SDM.RStests."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a></li>
    <li><a class="dropdown-item" href="../articles/nb_sf.html">Creating Neighbours using sf objects</a></li>
    <li><a class="dropdown-item" href="../articles/nb.html">Creating Neighbours</a></li>
    <li><a class="dropdown-item" href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a></li>
    <li><a class="dropdown-item" href="../articles/subgraphs.html">No-neighbour observation and subgraph handling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spdep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rao's score (a.k.a Lagrange Multiplier) diagnostics for spatial dependence in linear models</h1>

      <div class="d-none name"><code>lm.RStests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function reports the estimates of tests chosen among five statistics for
testing for spatial dependence in linear models. The statistics are
the simple RS test for error dependence (“RSerr”), the simple RS test
for a missing spatially lagged dependent variable (“RSlag”), variants
of these adjusted for the presence of the other (“adjRSerr”
tests for error dependence in the possible presence of a missing lagged
dependent variable, “adjRSlag” the other way round), and a portmanteau test
(“SARMA”, in fact “RSerr” + “adjRSlag”). Note: from spdep 1.3-2, the tests are re-named “RS” - Rao's score tests, rather than “LM” - Lagrange multiplier tests to match the naming of tests from the same family in <code>SDM.RStests</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>lm.RStests(model, listw, zero.policy=attr(listw, "zero.policy"), test="RSerr",
 spChk=NULL, naSubset=TRUE)
lm.LMtests(model, listw, zero.policy=attr(listw, "zero.policy"), test="LMerr",
 spChk=NULL, naSubset=TRUE)
# S3 method for class 'RStestlist'
print(x, ...)
# S3 method for class 'RStestlist'
summary(object, p.adjust.method="none", ...)
# S3 method for class 'RStestlist.summary'
print(x, digits=max(3, getOption("digits") - 2), ...)
&lt;!-- %tracew(listw) --&gt;</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>an object of class <code>lm</code> returned by <code>lm</code>, or optionally a vector of externally calculated residuals (run though <code>na.omit</code> if any NAs present) for use when only "RSerr" is chosen; weights and offsets should not be used in the <code>lm</code> object</p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>,
expected to be row-standardised (W-style)</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without
neighbours, if FALSE assign NA</p></dd>

  <dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>a character vector of tests requested chosen from RSerr, RSlag,
adjRSerr, adjRSlag, SARMA; test="all" computes all the tests.</p></dd>

  <dt id="arg-spchk">spChk<a class="anchor" aria-label="anchor" href="#arg-spchk"></a></dt>
<dd><p>should the data vector names be checked against the spatial objects for identity integrity, TRUE, or FALSE, default NULL to use <code><a href="set.spChkOption.html">get.spChkOption()</a></code></p></dd>

  <dt id="arg-nasubset">naSubset<a class="anchor" aria-label="anchor" href="#arg-nasubset"></a></dt>
<dd><p>default TRUE to subset listw object for omitted observations in model object (this is a change from earlier behaviour, when the <code>model$na.action</code> component was ignored, and the listw object had to be subsetted by hand)</p></dd>

  <dt id="arg-x-object">x, object<a class="anchor" aria-label="anchor" href="#arg-x-object"></a></dt>
<dd><p>object to be printed</p></dd>

  <dt id="arg-p-adjust-method">p.adjust.method<a class="anchor" aria-label="anchor" href="#arg-p-adjust-method"></a></dt>
<dd><p>a character string specifying the probability value adjustment (see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>) for multiple tests, default "none"</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>minimum number of significant digits to be used for most numbers</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>printing arguments to be passed through</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The two types of dependence are for spatial lag \(\rho\) and spatial error \(\lambda\):</p>
<p>$$
\mathbf{y} = \mathbf{X \beta} + \rho \mathbf{W_{(1)} y} + \mathbf{u},
$$
$$
\mathbf{u} = \lambda \mathbf{W_{(2)} u} + \mathbf{e}
$$</p>
<p>where \(\mathbf{e}\) is a well-behaved, uncorrelated error
term. Tests for a missing spatially lagged dependent variable test
that \(\rho = 0\), tests for spatial autocorrelation of
the error \(\mathbf{u}\) test whether \(\lambda = 0\). \(\mathbf{W}\) is a spatial weights matrix; for the tests used
here they are identical.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>RStestlist</code> of <code>htest</code> objects, each with:</p>
<dl><dt>statistic</dt>
<dd><p>the value of the Rao's score (a.k.a Lagrange multiplier) test.</p></dd>

  <dt>parameter</dt>
<dd><p>number of degrees of freedom</p></dd>

  <dt>p.value</dt>
<dd><p>the p-value of the test.</p></dd>

  <dt>method</dt>
<dd><p>a character string giving the method used.</p></dd>

  <dt>data.name</dt>
<dd><p>a character string giving the name(s) of the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Anselin, L. 1988 Spatial econometrics: methods and
models. (Dordrecht: Kluwer); Anselin, L., Bera, A. K., Florax, R. and
Yoon, M. J. 1996 Simple diagnostic tests for spatial dependence. Regional
Science and Urban Economics, 26, 77–104 <a href="https://doi.org/10.1016/0166-0462%2895%2902111-6" class="external-link">doi:10.1016/0166-0462(95)02111-6</a>
;
Malabika Koley (2024) Specification Testing under General Nesting Spatial
Model, <a href="https://sites.google.com/view/malabikakoley/research" class="external-link">https://sites.google.com/view/malabikakoley/research</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a> and Andrew Bernat</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="SD.RStests.html">SD.RStests</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">oldcrime.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="va">INC</span>, data <span class="op">=</span> <span class="va">COL.OLD</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">oldcrime.lm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = CRIME ~ HOVAL + INC, data = COL.OLD)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -34.418  -6.388  -1.580   9.052  28.649 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  68.6190     4.7355  14.490  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HOVAL        -0.2739     0.1032  -2.654   0.0109 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INC          -1.5973     0.3341  -4.780 1.83e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 11.43 on 46 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.5524,	Adjusted R-squared:  0.5329 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 28.39 on 2 and 46 DF,  p-value: 9.341e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">lm.RStests</span><span class="op">(</span><span class="va">oldcrime.lm</span>, listw<span class="op">=</span><span class="va">lw</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	dependence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = CRIME ~ HOVAL + INC, data = COL.OLD)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test weights: lw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          statistic parameter  p.value   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RSerr     5.723131         1 0.016743 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RSlag     9.363684         1 0.002213 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjRSerr  0.079495         1 0.777983   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjRSlag  3.720048         1 0.053763 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SARMA     9.443178         2 0.008901 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/r-spatial/spatialreg/" class="external-link">"spatialreg"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">oldcrime.slx</span> <span class="op">&lt;-</span> <span class="fu"><a href="spdep-defunct.html">lmSLX</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="va">INC</span>, data <span class="op">=</span> <span class="va">COL.OLD</span>, listw<span class="op">=</span><span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">lm.RStests</span><span class="op">(</span><span class="va">oldcrime.slx</span>, listw<span class="op">=</span><span class="va">lw</span>, test<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	dependence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(CRIME ~ HOVAL + INC + lag.HOVAL + lag.INC, data = COL.OLD,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> listw = lw)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test weights: lw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNM_adjRSerr   0.10933         1  0.7409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNM_adjRSlag   0.61580         1  0.4326</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

