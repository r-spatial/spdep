<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read and write spatial neighbour files — read.gwt2nb • spdep</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read and write spatial neighbour files — read.gwt2nb"><meta property="og:description" content="The &quot;gwt&quot; functions read and write GeoDa GWT files (the example file baltk4.GWT was downloaded from the site given in the reference), and the &quot;dat&quot; functions read and write Matlab sparse matrix files as used by James LeSage's Spatial Econometrics Toolbox (the example file wmat.dat was downloaded from the site given in the reference). The body of the files after any headers should have three columns separated by white space, and the third column must be numeric in the locale of the reading platform (correct decimal separator)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3-6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/nb.html">Creating Neighbours</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a>
    </li>
    <li>
      <a href="../articles/subgraphs.html">No-neighbour observation and subgraph handling</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/r-spatial/spdep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read and write spatial neighbour files</h1>

    <div class="hidden name"><code>read.gwt2nb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The "gwt" functions read and write GeoDa GWT files (the example file baltk4.GWT was downloaded from the site given in the reference), and the "dat" functions read and write Matlab sparse matrix files as used by James LeSage's Spatial Econometrics Toolbox (the example file wmat.dat was downloaded from the site given in the reference). The body of the files after any headers should have three columns separated by white space, and the third column must be numeric in the locale of the reading platform (correct decimal separator).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read.gwt2nb</span><span class="op">(</span><span class="va">file</span>, region.id<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">write.sn2gwt</span><span class="op">(</span><span class="va">sn</span>, <span class="va">file</span>, shpfile<span class="op">=</span><span class="cn">NULL</span>, ind<span class="op">=</span><span class="cn">NULL</span>, useInd<span class="op">=</span><span class="cn">FALSE</span>, legacy<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">read.dat2listw</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span><span class="fu">write.sn2dat</span><span class="op">(</span><span class="va">sn</span>, <span class="va">file</span><span class="op">)</span></span>
<span><span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="cn">NULL</span>, style<span class="op">=</span><span class="cn">NULL</span>, zero.policy<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">read_swm_dbf</span><span class="op">(</span><span class="va">fn</span><span class="op">)</span></span>
<span><span class="fu">write.sn2DBF</span><span class="op">(</span><span class="va">sn</span>, <span class="va">file</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-file-fn">file, fn<a class="anchor" aria-label="anchor" href="#arg-file-fn"></a></dt>
<dd><p>name of file with weights data</p></dd>

  <dt id="arg-region-id">region.id<a class="anchor" aria-label="anchor" href="#arg-region-id"></a></dt>
<dd><p>a character vector of region IDs - for ArcGIS SWM DBFs, the values must be character integers (only numbers not starting with zero)</p></dd>

  <dt id="arg-sn">sn<a class="anchor" aria-label="anchor" href="#arg-sn"></a></dt>
<dd><p>a <code>spatial.neighbour</code> object</p></dd>

  <dt id="arg-shpfile">shpfile<a class="anchor" aria-label="anchor" href="#arg-shpfile"></a></dt>
<dd><p>character string: if not given Shapefile name taken from GWT file for this dataset</p></dd>

  <dt id="arg-ind">ind<a class="anchor" aria-label="anchor" href="#arg-ind"></a></dt>
<dd><p>character string: region id indicator field name</p></dd>

  <dt id="arg-useind">useInd<a class="anchor" aria-label="anchor" href="#arg-useind"></a></dt>
<dd><p>default FALSE, if TRUE, write <code>region.id</code> attribute ID key tags to output file (use in OpenGeoDa will depend on the shapefile having the field named in the <code>ind</code> argument matching the exported tags)</p></dd>

  <dt id="arg-legacy">legacy<a class="anchor" aria-label="anchor" href="#arg-legacy"></a></dt>
<dd><p>default FALSE; if TRUE, header has single field with number of observations only</p></dd>

  <dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>default NULL, missing, set to "M" and warning given; if not "M", passed to <code><a href="nb2listw.html">nb2listw</a></code> to re-build the object</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default NULL, use global option value; if FALSE stop with error for any empty neighbour sets, if TRUE permit the weights list to be formed with zero-length weights vectors</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Attempts to honour the region.id argument given when reading GWT and SWM/DBF files. If the region IDs given in <code>region.id=</code> do not match the origins or destinations in the GWT file, an error or warning will be thrown, which should be considered carefully. <code>read_swm_dbf</code> is a simplified interface to <code>read.swmdbf2listw</code> When no-neighbour observations are present, it is advised that <code>region.id=</code> be given in <code>read.swmdbf2listw</code>; while the function should read correctly if the minimum and maximum IDs are present as observations with neighbours without <code>region.id=</code> set, reading using <code>read.swmdbf2listw</code> will fail when the minimum or maximum ID observations have no neighbours and <code>region.id=</code> is not given.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>read.gwt2nb</code> returns a neighbour "nb" object with the generalised weights stored as a list element called "dlist" of the "GeoDa" attribute; <code>read.swmdbf2listw</code> returns a "listw" object read from a DBF file exported from an ArcGIS SWM object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Luc Anselin (2003) <em>GeoDa 0.9 User's Guide</em>, pp. 80–81, Spatial Analysis Laboratory, Department of Agricultural and Consumer Economics, University of Illinois, Urbana-Champaign, <a href="http://geodacenter.github.io/docs/geoda093.pdf" class="external-link">http://geodacenter.github.io/docs/geoda093.pdf</a>; also material formerly at spatial-econometrics.com/data/contents.html</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="read.gal.html">read.gal</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">baltimore</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">STATION</span> <span class="op">&lt;-</span> <span class="va">baltimore</span><span class="op">$</span><span class="va">STATION</span></span></span>
<span class="r-in"><span><span class="va">gwt1</span> <span class="op">&lt;-</span> <span class="fu">read.gwt2nb</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"weights/baltk4.GWT"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span> <span class="va">STATION</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>102, 115, 208 are not destinations</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Neighbours list symmetry;"</span>, <span class="fu"><a href="testnb.html">is.symmetric.nb</a></span><span class="op">(</span><span class="va">gwt1</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbours list symmetry; FALSE </span>
<span class="r-in"><span><span class="va">listw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">gwt1</span>, style<span class="op">=</span><span class="st">"B"</span>, glist<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">gwt1</span>, <span class="st">"GeoDa"</span><span class="op">)</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmpGWT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write.sn2gwt</span><span class="op">(</span><span class="fu"><a href="listw2sn.html">listw2sn</a></span><span class="op">(</span><span class="va">listw1</span><span class="op">)</span>, <span class="va">tmpGWT</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gwt2</span> <span class="op">&lt;-</span> <span class="fu">read.gwt2nb</span><span class="op">(</span><span class="va">tmpGWT</span>, <span class="va">STATION</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>102, 115, 208 are not destinations</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Neighbours list symmetry;"</span>, <span class="fu"><a href="testnb.html">is.symmetric.nb</a></span><span class="op">(</span><span class="va">gwt2</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbours list symmetry; FALSE </span>
<span class="r-in"><span><span class="fu"><a href="diffnb.html">diffnb</a></span><span class="op">(</span><span class="va">gwt1</span>, <span class="va">gwt2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 211 sub-graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbour list object:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of regions: 211 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of nonzero links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percentage nonzero weights: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average number of links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 211 regions with no links:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 206, 207, 208, 209, 210, 211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 211 disjoint connected subgraphs</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oldcol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmpMAT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">COL.W</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">COL.nb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write.sn2dat</span><span class="op">(</span><span class="fu"><a href="listw2sn.html">listw2sn</a></span><span class="op">(</span><span class="va">COL.W</span><span class="op">)</span>, <span class="va">tmpMAT</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">listwmat1</span> <span class="op">&lt;-</span> <span class="fu">read.dat2listw</span><span class="op">(</span><span class="va">tmpMAT</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>style is M (missing); style should be set to a valid value</span>
<span class="r-in"><span><span class="fu"><a href="diffnb.html">diffnb</a></span><span class="op">(</span><span class="va">listwmat1</span><span class="op">$</span><span class="va">neighbours</span>, <span class="va">COL.nb</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id differ; using ids of first list</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 49 sub-graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbour list object:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of regions: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of nonzero links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percentage nonzero weights: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average number of links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 regions with no links:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 disjoint connected subgraphs</span>
<span class="r-in"><span><span class="va">listwmat2</span> <span class="op">&lt;-</span> <span class="fu">read.dat2listw</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/weights/wmat.dat"</span>, </span></span>
<span class="r-in"><span> package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>style is M (missing); style should be set to a valid value</span>
<span class="r-in"><span><span class="fu"><a href="diffnb.html">diffnb</a></span><span class="op">(</span><span class="va">listwmat1</span><span class="op">$</span><span class="va">neighbours</span>, <span class="va">listwmat2</span><span class="op">$</span><span class="va">neighbours</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 49 sub-graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbour list object:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of regions: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of nonzero links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percentage nonzero weights: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average number of links: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 regions with no links:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 disjoint connected subgraphs</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/foreign/" class="external-link">"foreign"</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">nc_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"gpkg/nc.gpkg"</span>, package<span class="op">=</span><span class="st">"sf"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc_sf</span><span class="op">$</span><span class="va">UniqueID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nc_sf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/misc/nc_contiguity_unique_id.dbf"</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nc1</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc1</span></span></span>
<span class="r-in"><span><span class="va">nc1a</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nc_sf</span><span class="op">$</span><span class="va">UniqueID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">nc1</span>, <span class="va">nc1a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/misc/nc_contiguity_unique_id_islands.dbf"</span>,</span></span>
<span class="r-in"><span> package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">nc1i</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc1i</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc1ia</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">nc_sf</span><span class="op">$</span><span class="va">UniqueID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc1ia</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">nc1i</span>, <span class="va">nc1ia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">as.numeric_version</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf_extSoftVersion.html" class="external-link">sf_extSoftVersion</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"GDAL"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.7.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/shapes/california.gpkg.zip"</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/misc/contiguity_myid.dbf"</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">cal1</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1a</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cal</span><span class="op">$</span><span class="va">MYID</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal1</span>, <span class="va">cal1a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/misc/contiguity_unique_id.dbf"</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">cal2</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal2a</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cal</span><span class="op">$</span><span class="va">UniqueID</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal2</span>, <span class="va">cal2a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"etc/misc/contiguity_unique_id_islands.dbf"</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">cal3i</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal3i</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal3ia</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">fn</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cal</span><span class="op">$</span><span class="va">UniqueID</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal3i</span>, <span class="va">cal3ia</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1a_1n_nb</span> <span class="op">&lt;-</span> <span class="va">cal1a</span><span class="op">$</span><span class="va">neighbours</span></span></span>
<span class="r-in"><span><span class="va">cal1a_1n_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="droplinks.html">droplinks</a></span><span class="op">(</span><span class="va">cal1a_1n_nb</span>, drop<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"158"</span>, <span class="st">"180"</span>, <span class="st">"215"</span><span class="op">)</span>, sym<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1a_1n</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">cal1a_1n_nb</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1a_1n_sn</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw2sn.html">listw2sn</a></span><span class="op">(</span><span class="va">cal1a_1n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext<span class="op">=</span><span class="st">".dbf"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write.sn2DBF</span><span class="op">(</span><span class="va">cal1a_1n_sn</span>, <span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1a_1n_rt</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">file</span>, region.id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cal</span><span class="op">$</span><span class="va">MYID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal1a_1n</span><span class="op">$</span><span class="va">neighbours</span>, <span class="va">cal1a_1n_rt</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal1a_1n</span><span class="op">$</span><span class="va">weights</span>, <span class="va">cal1a_1n_rt</span><span class="op">$</span><span class="va">weights</span>, check.attributes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cal1_1n_rt</span> <span class="op">&lt;-</span> <span class="fu">read.swmdbf2listw</span><span class="op">(</span><span class="va">file</span>, style<span class="op">=</span><span class="st">"B"</span>, zero.policy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal1a_1n</span><span class="op">$</span><span class="va">neighbours</span>, <span class="va">cal1_1n_rt</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/all.equal-methods.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cal1a_1n</span><span class="op">$</span><span class="va">weights</span>, <span class="va">cal1_1n_rt</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `nc.gpkg' from data source `/home/rsb/lib/r_libs/sf/gpkg/nc.gpkg' using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 100 features and 14 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: MULTIPOLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  NAD27</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:100</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:100</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>81 is not an origin</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in read.swmdbf2listw(fn, style = "B") : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Error in sn2listw(df1, style = style, zero.policy = zero.policy) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   no-neighbour observations found, set zero.policy to TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `california' from data source </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `/tmp/RtmprC66Rb/temp_libpath592b71c95cd22/spdep/etc/shapes/california.gpkg.zip' </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 58 features and 2 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: MULTIPOLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -13847330 ymin: 3810869 xmax: -12704360 ymax: 5132708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: World_Mercator</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 158:215</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:58</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:58</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>21, 38 are not origins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in read.swmdbf2listw(fn, style = "B") : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Error in sn2listw(df1, style = style, zero.policy = zero.policy) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   no-neighbour observations found, set zero.policy to TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 1:58</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some observations have no neighbours</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 4 sub-graphs</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 4 sub-graphs</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>region.id not given, c(MYID, NID) range is 159:214</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 2 sub-graphs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

