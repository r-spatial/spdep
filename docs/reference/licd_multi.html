<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Local Indicators for Categorical Data — licd_multi • spdep</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Local Indicators for Categorical Data — licd_multi"><meta name="description" content="Local indicators for categorical data combine a measure of local composition in a window given by the per-observation set of neighbouring observations, with a local multi-category joincount test simplified to neighbours with the same or different categories compared to the focal observation"><meta property="og:description" content="Local indicators for categorical data combine a measure of local composition in a window given by the per-observation set of neighbouring observations, with a local multi-category joincount test simplified to neighbours with the same or different categories compared to the focal observation"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3-6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a></li>
    <li><a class="dropdown-item" href="../articles/nb_sf.html">Creating Neighbours using sf objects</a></li>
    <li><a class="dropdown-item" href="../articles/nb.html">Creating Neighbours</a></li>
    <li><a class="dropdown-item" href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a></li>
    <li><a class="dropdown-item" href="../articles/subgraphs.html">No-neighbour observation and subgraph handling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spdep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Local Indicators for Categorical Data</h1>

      <div class="d-none name"><code>licd_multi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Local indicators for categorical data combine a measure of local composition in a window given by the per-observation set of neighbouring observations, with a local multi-category joincount test simplified to neighbours with the same or different categories compared to the focal observation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">licd_multi</span><span class="op">(</span><span class="va">fx</span>, <span class="va">listw</span>, zero.policy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">listw</span>, <span class="st">"zero.policy"</span><span class="op">)</span>, adjust.n <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span> nsim <span class="op">=</span> <span class="fl">0L</span>, iseed <span class="op">=</span> <span class="cn">NULL</span>, no_repeat_in_row <span class="op">=</span> <span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-fx">fx<a class="anchor" aria-label="anchor" href="#arg-fx"></a></dt>
<dd><p>a factor with two or more categories, of the same length as the neighbours and weights objects in listw</p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without neighbours, if FALSE assign NA</p></dd>

  <dt id="arg-adjust-n">adjust.n<a class="anchor" aria-label="anchor" href="#arg-adjust-n"></a></dt>
<dd><p>default TRUE, if FALSE the number of observations is not adjusted for no-neighbour observations, if TRUE, the number of observations is adjusted</p></dd>

  <dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>default 0, number of conditonal permutation simulations</p></dd>

  <dt id="arg-iseed">iseed<a class="anchor" aria-label="anchor" href="#arg-iseed"></a></dt>
<dd><p>default NULL, used to set the seed; the output will only be reproducible if the count of CPU cores across which computation is distributed is the same</p></dd>

  <dt id="arg-no-repeat-in-row">no_repeat_in_row<a class="anchor" aria-label="anchor" href="#arg-no-repeat-in-row"></a></dt>
<dd><p>default <code>FALSE</code>, if <code>TRUE</code>, sample conditionally in each row without replacements to avoid duplicate values, <a href="https://github.com/r-spatial/spdep/issues/124" class="external-link">https://github.com/r-spatial/spdep/issues/124</a></p></dd>

  <dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>comp_binary=TRUE, binomial_punif_alternative="greater",
        jcm_same_punif_alternative="less", jcm_diff_punif_alternative="greater"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The original code may be found at <a href="https://doi.org/10.5281/zenodo.4283766" class="external-link">doi:10.5281/zenodo.4283766</a></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<dl><dt>local_comp</dt>
<dd><p>data.frame object with LICD local composition columns: ID,
    category_i, count_like_i, prop_i, count_nbs_i, pbinom_like_BW,
    pbinom_unlike_BW, pbinom_unlike_BW_alt, chi_BW_i, chi_K_i, anscombe_BW</p></dd>

  <dt>local_config</dt>
<dd><p>data.frame object with LICD local configuration columns: ID, jcm_chi_obs, jcm_count_BB_obs, jcm_count_BW_obs, jcm_count_WW_obs, pval_jcm_obs_BB, pval_jcm_obs_WW, pval_jcm_obs_BW</p></dd>

  <dt>local_comp_sim</dt>
<dd><p>data.frame object with permutation-based LICD local composition columns: ID, pbinom_like_BW, pbinom_unlike_BW, pbinom_unlike_BW_alt, rank_sim_chi_BW, rank_sim_chi_K, rank_sim_anscombe</p></dd>

  <dt>local_config_sim</dt>
<dd><p>data.frame object with permutation-based LICD local configuration columns: ID, jcm_chi_sim_rank, pval_jcm_obs_BB_sim, pval_jcm_obs_BW_sim, pval_jcm_obs_WW_sim</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 20;</p>
<p>Upton, G., Fingleton, B. 1985 Spatial data analysis by example: point pattern and qualitative data, Wiley, pp. 158–170;</p>
<p>Boots, B., 2003. Developing local measures of spatial association for categorical data. Journal of Geographical Systems 5, 139–160;</p>
<p>Boots, B., 2006. Local configuration measures for categorical spatial data: binary regular lattices. Journal of Geographical Systems 8 (1), 1–24;</p>
<p>Pietrzak, M.B., Wilk, J., Kossowski, T., Bivand, R.S., 2014. The application of local indicators for categorical data (LICD) in the spatial analysis of economic development. Comparative Economic Research 17 (4), 203–220 <a href="https://doi.org/10.2478/cer-2014-0041" class="external-link">doi:10.2478/cer-2014-0041</a>
;</p>
<p>Bivand, R.S., Wilk, J., Kossowski, T., 2017. Spatial association of population pyramids across Europe: The application of symbolic data, cluster analysis and join-count tests. Spatial Statistics 21 (B), 339–361 <a href="https://doi.org/10.1016/j.spasta.2017.03.003" class="external-link">doi:10.1016/j.spasta.2017.03.003</a>
;</p>
<p>Francesco Carrer, Tomasz M. Kossowski, Justyna Wilk, Michał B. Pietrzak, Roger S. Bivand, The application of Local Indicators for Categorical Data (LICD) to explore spatial dependence in archaeological spaces, Journal of Archaeological Science, 126, 2021, <a href="https://doi.org/10.1016/j.jas.2020.105306" class="external-link">doi:10.1016/j.jas.2020.105306</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a> based on earlier code by Tomasz M. Kossowski, Justyna Wilk and Michał B. Pietrzak</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In order to increase the numbers of neighbours using <code><a href="nblag.html">nblag</a></code> and <code><a href="nblag.html">nblag_cumul</a></code> is advisable; use of binary weights is advised and are in any case used for the composition measure</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="joincount.multi.html">joincount.multi</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">columbus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/columbus.gpkg"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">HICRIME</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">columbus</span><span class="op">$</span><span class="va">CRIME</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">35</span>,<span class="fl">80</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>,<span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="va">columbus</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Neighbour list object:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of regions: 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of nonzero links: 236 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Percentage nonzero weights: 9.829238 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Average number of links: 4.816327 </span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="fu"><a href="nblag.html">nblag_cumul</a></span><span class="op">(</span><span class="fu"><a href="nblag.html">nblag</a></span><span class="op">(</span><span class="va">nb</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">licd_multi</span><span class="op">(</span><span class="va">HICRIME</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_comp      :'data.frame':	49 obs. of  11 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ID                  : int [1:49] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ category_i          : num [1:49] 1 1 1 1 2 1 1 2 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ count_like_i        : num [1:49] 4 4 6 7 12 7 2 8 10 8 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ prop_i              : num [1:49] 0.51 0.51 0.51 0.51 0.49 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ count_nbs_i         : num [1:49] 5 6 11 14 22 14 11 14 25 17 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pbinom_like_BW      : num [1:49] 0.965 0.881 0.702 0.575 0.769 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pbinom_unlike_BW    : num [1:49] 0.0346 0.1192 0.2979 0.4255 0.2313 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pbinom_unlike_BW_alt: num [1:49] 0.201 0.363 0.528 0.634 0.379 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ chi_BW_i            : num [1:49] 1.68033 0.58778 0.0547 0.00583 0.27273 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ chi_K_i             : num [1:49] 1.68033 0.58778 0.0547 0.00583 0.27273 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ anscombe_BW         : num [1:49] 1.06 0.936 0.828 0.785 0.829 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_config    :'data.frame':	49 obs. of  8 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ID              : int [1:49] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_chi_obs     : num [1:49] 0 0.0625 0.625 2.7468 14.1889 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_count_BB_obs: num [1:49] 6 6 11 12 55 15 1 27 30 25 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_count_BW_obs: num [1:49] 4 7 23 31 50 36 15 31 73 53 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_count_WW_obs: num [1:49] 0 1 10 20 21 19 32 9 61 24 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pval_jcm_obs_BB : num [1:49] 1 0.207108 0.70232 0.820405 0.000214 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pval_jcm_obs_WW : num [1:49] 1 0.3946 0.0981 0.0243 0.7839 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ pval_jcm_obs_BW : num [1:49] 1.00 1.75e-01 2.08e-01 5.10e-02 3.52e-06 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_comp_sim  : NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_config_sim: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "out")= num [1:49, 1:29] 1 1 1 1 2 1 1 2 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "ncpus")= int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:29] "category_i" "count_like_i" "prop_i" "count_nbs_i" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "ncpus")= int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "nsim")= int 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "con")=List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ comp_binary               : logi TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ binomial_punif_alternative: chr "greater"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_same_punif_alternative: chr "less"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ jcm_diff_punif_alternative: chr "greater"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "class")= chr [1:2] "licd" "list"</span>
<span class="r-in"><span><span class="va">h_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="hotspotmap.html">hotspot</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">h_obj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ID              : int [1:49] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_comp      : Factor w/ 2 levels "Cluster","Dispersed": 2 2 2 2 2 2 2 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_comp_sim  : NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_config    : Factor w/ 3 levels "Cluster","Dispersed",..: 3 3 3 3 2 3 3 2 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ local_config_sim: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ both            : Factor w/ 6 levels "Cluster.Cluster",..: 6 6 6 6 4 6 6 4 6 6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ both_sim        : NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ both_recode     : Factor w/ 4 levels "Clump","Cluster",..: 4 4 4 4 3 4 4 3 4 4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ both_recode_sim : NULL</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">h_obj</span><span class="op">$</span><span class="va">both_recode</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Clump    Cluster  Dispersed No cluster </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          3         11         27 </span>
<span class="r-in"><span><span class="va">columbus</span><span class="op">$</span><span class="va">both</span> <span class="op">&lt;-</span> <span class="va">h_obj</span><span class="op">$</span><span class="va">both_recode</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">columbus</span><span class="op">[</span>, <span class="st">"both"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="licd_multi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">GDAL37</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">as.numeric_version</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf_extSoftVersion.html" class="external-link">sf_extSoftVersion</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"GDAL"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="st">"3.7.0"</span></span></span>
<span class="r-in"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="st">"etc/shapes/GB_2024_southcoast_50m.gpkg.zip"</span></span></span>
<span class="r-in"><span><span class="va">zipfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="va">file</span>, package<span class="op">=</span><span class="st">"spdep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">GDAL37</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">sc50m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">zipfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".zip"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">zipfile</span>, files<span class="op">=</span><span class="va">bn</span>, exdir<span class="op">=</span><span class="va">td</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">sc50m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">target</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `GB_2024_southcoast_50m' from data source </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `/tmp/RtmpqhccSk/temp_libpath108a2257736002/spdep/etc/shapes/GB_2024_southcoast_50m.gpkg.zip' </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 119 features and 19 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: MULTIPOLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 82643.12 ymin: 5342.9 xmax: 640301.6 ymax: 187226.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: OSGB36 / British National Grid</span>
<span class="r-in"><span><span class="va">sc50m</span><span class="op">$</span><span class="va">Winner</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">$</span><span class="va">Winner</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Con"</span>, <span class="st">"Green"</span>, <span class="st">"Lab"</span>, <span class="st">"LD"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">[</span>,<span class="st">"Winner"</span><span class="op">]</span>, pal<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#2297E6"</span>, <span class="st">"#61D04F"</span>, <span class="st">"#DF536B"</span>, <span class="st">"#F5C710"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="licd_multi-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">nb_sc_50m</span> <span class="op">&lt;-</span> <span class="fu"><a href="poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="va">sc50m</span>, row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">$</span><span class="va">Constituency</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>neighbour object has 2 sub-graphs;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> if this sub-graph count seems unexpected, try increasing the snap argument.</span>
<span class="r-in"><span><span class="va">sub2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"region.id"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"ncomp"</span><span class="op">)</span><span class="op">$</span><span class="va">comp.id</span> <span class="op">==</span> <span class="fl">2L</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">iowe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">sub2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"region.id"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diowe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_distance</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">[</span><span class="va">iowe</span>,<span class="op">]</span>, <span class="va">sc50m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meet_criterion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diowe</span> <span class="op">&lt;=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"m"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cands</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"region.id"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">diowe</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">meet_criterion</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nb_sc_50m_iowe</span> <span class="op">&lt;-</span> <span class="fu"><a href="droplinks.html">addlinks1</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, from <span class="op">=</span> <span class="va">cands</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span> to <span class="op">=</span> <span class="va">cands</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="va">meet_criterion</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ioww</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">sub2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"region.id"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dioww</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_distance</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">[</span><span class="va">ioww</span>,<span class="op">]</span>, <span class="va">sc50m</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meet_criterion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dioww</span> <span class="op">&lt;=</span> <span class="fu">units</span><span class="fu">::</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">5000</span>, <span class="st">"m"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cands</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nb_sc_50m</span>, <span class="st">"region.id"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dioww</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">meet_criterion</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nb_sc_50m_iow</span> <span class="op">&lt;-</span> <span class="fu"><a href="droplinks.html">addlinks1</a></span><span class="op">(</span><span class="va">nb_sc_50m_iowe</span>, from <span class="op">=</span> <span class="va">cands</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">cands</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="va">meet_criterion</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nb_sc_1_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="nblag.html">nblag_cumul</a></span><span class="op">(</span><span class="fu"><a href="nblag.html">nblag</a></span><span class="op">(</span><span class="va">nb_sc_50m_iow</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">nb_sc_1_2</span>, style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">licd_obj</span> <span class="op">&lt;-</span> <span class="fu">licd_multi</span><span class="op">(</span><span class="va">sc50m</span><span class="op">$</span><span class="va">Winner</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="hotspotmap.html">hotspot</a></span><span class="op">(</span><span class="va">licd_obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sc50m</span><span class="op">$</span><span class="va">both</span> <span class="op">&lt;-</span> <span class="va">h_obj</span><span class="op">$</span><span class="va">both_recode</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">[</span>, <span class="st">"both"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="licd_multi-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ljc</span> <span class="op">&lt;-</span> <span class="fu"><a href="local_joincount_uni.html">local_joincount_uni</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">$</span><span class="va">Winner</span> <span class="op">==</span> <span class="st">"LD"</span><span class="op">)</span>, chosen<span class="op">=</span><span class="st">"TRUE"</span>, <span class="va">lw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sc50m</span><span class="op">$</span><span class="va">LD_pv</span> <span class="op">&lt;-</span> <span class="va">ljc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sc50m</span><span class="op">[</span>, <span class="st">"LD_pv"</span><span class="op">]</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="licd_multi-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

