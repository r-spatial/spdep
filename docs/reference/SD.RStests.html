<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rao's score and adjusted Rao's score tests of linear hypotheses for spatial Durbin and spatial Durbin error models — SD.RStests • spdep</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Rao's score and adjusted Rao's score tests of linear hypotheses for spatial Durbin and spatial Durbin error models — SD.RStests"><meta name="description" content="Rao's score and adjusted Rao's score tests of linear hypotheses applied to a fitted linear model to examine whether either the spatially lagged dependent variable lag or the spatially lagged independent variable(s) WX should be included in the model, or both (SDM). Adjusted tests are provided for lag and WX adapting to the presence of the other, and a joint test for both. The joint test is equal to the unadjusted of one plus the adjusted of the other. In addition, draft tests are added from Koley (2024, section 6) for spatial Durbin error models to examine whether either the spatially lagged error err or the spatially lagged independent variable(s) WX should be included in the model, or both (SDEM); because of orthogonality, no adjusted tests are required.
Because the spatial lags of categorical variables are poorly understood, from version 1.3-11 warnings are given when categorical variables are included in the Durbin term."><meta property="og:description" content="Rao's score and adjusted Rao's score tests of linear hypotheses applied to a fitted linear model to examine whether either the spatially lagged dependent variable lag or the spatially lagged independent variable(s) WX should be included in the model, or both (SDM). Adjusted tests are provided for lag and WX adapting to the presence of the other, and a joint test for both. The joint test is equal to the unadjusted of one plus the adjusted of the other. In addition, draft tests are added from Koley (2024, section 6) for spatial Durbin error models to examine whether either the spatially lagged error err or the spatially lagged independent variable(s) WX should be included in the model, or both (SDEM); because of orthogonality, no adjusted tests are required.
Because the spatial lags of categorical variables are poorly understood, from version 1.3-11 warnings are given when categorical variables are included in the Durbin term."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spdep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a></li>
    <li><a class="dropdown-item" href="../articles/nb_sf.html">Creating Neighbours using sf objects</a></li>
    <li><a class="dropdown-item" href="../articles/nb.html">Creating Neighbours</a></li>
    <li><a class="dropdown-item" href="../articles/sids.html">Introduction to the North Carolina SIDS data set (re-revised)</a></li>
    <li><a class="dropdown-item" href="../articles/subgraphs.html">No-neighbour observation and subgraph handling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-spatial/spdep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Rao's score and adjusted Rao's score tests of linear hypotheses for spatial Durbin and spatial Durbin error models</h1>

      <div class="d-none name"><code>SD.RStests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Rao's score and adjusted Rao's score tests of linear hypotheses applied to a fitted linear model to examine whether either the spatially lagged dependent variable <code>lag</code> or the spatially lagged independent variable(s) <code>WX</code> should be included in the model, or both (SDM). Adjusted tests are provided for <code>lag</code> and <code>WX</code> adapting to the presence of the other, and a joint test for both. The joint test is equal to the unadjusted of one plus the adjusted of the other. In addition, draft tests are added from Koley (2024, section 6) for spatial Durbin error models to examine whether either the spatially lagged error <code>err</code> or the spatially lagged independent variable(s) <code>WX</code> should be included in the model, or both (SDEM); because of orthogonality, no adjusted tests are required.</p>
<p>Because the spatial lags of categorical variables are poorly understood, from version 1.3-11 warnings are given when categorical variables are included in the Durbin term.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SD.RStests</span><span class="op">(</span><span class="va">model</span>, <span class="va">listw</span>, zero.policy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">listw</span>, <span class="st">"zero.policy"</span><span class="op">)</span>, test <span class="op">=</span> <span class="st">"SDM"</span>,</span>
<span> Durbin <span class="op">=</span> <span class="cn">TRUE</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">have_factor_preds_mf</span><span class="op">(</span><span class="va">mf</span><span class="op">)</span></span>
<span><span class="fu">warn_factor_preds</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>an object of class <code>lm</code> returned by <code>lm</code></p></dd>

  <dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>a <code>listw</code> object created for example by <code>nb2listw</code>,
expected to be row-standardised (W-style)</p></dd>

  <dt id="arg-zero-policy">zero.policy<a class="anchor" aria-label="anchor" href="#arg-zero-policy"></a></dt>
<dd><p>default <code>attr(listw, "zero.policy")</code> as set when <code>listw</code> was created, if attribute not set, use global option value; if TRUE assign zero to the lagged value of zones without
neighbours, if FALSE assign NA</p></dd>

  <dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>test=“SDM” computes the SDM tests, a character vector of tests requested chosen from SDM_RSlag, SDM_adjRSlag, SDM_RSWX, SDM_adjRSWX, SDM_Joint, test=“SDEM” computes the SDEM tests, a character vector of tests requested chosen from SDEM_RSerr, SDEM_RSWX, SDEM_Joint; test=“all” computes all the tests</p></dd>

  <dt id="arg-durbin">Durbin<a class="anchor" aria-label="anchor" href="#arg-durbin"></a></dt>
<dd><p>default TRUE for Durbin models including WX; if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>original data object from lm() call, required if <code>Durbin</code> is a formula object, because the model frame must be regenerated from the original input data</p></dd>

  <dt id="arg-mf">mf<a class="anchor" aria-label="anchor" href="#arg-mf"></a></dt>
<dd><p><code>model.frame</code> object</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>object created by <code>have_factor_preds_mf</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>LMtestlist</code> of <code>htest</code> objects, each with:</p>
<dl><dt>statistic</dt>
<dd><p>the value of the Lagrange Multiplier test.</p></dd>

  <dt>parameter</dt>
<dd><p>number of degrees of freedom</p></dd>

  <dt>p.value</dt>
<dd><p>the p-value of the test.</p></dd>

  <dt>method</dt>
<dd><p>a character string giving the method used.</p></dd>

  <dt>data.name</dt>
<dd><p>a character string giving the name(s) of the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Malabika Koley and Anil K. Bera (2024) To use, or not to use the spatial Durbin model? – that is the question, Spatial Economic Analysis, 19:1, 30-56, <a href="https://doi.org/10.1080/17421772.2023.2256810" class="external-link">doi:10.1080/17421772.2023.2256810</a>
; Malabika Koley (2024) Specification testing of spatial econometric models, Ph.D. dissertation, University of Illinois at Urbana-Champaign, pp. 78-118, 148-156; <a href="https://hdl.handle.net/2142/124329" class="external-link">https://hdl.handle.net/2142/124329</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a>, Malabika Koley and Anil K. Bera</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The results in the example below agree with those in Table 3, p. 22 in Koley and Bera (2024).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="lm.RStests.html">lm.RStests</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">columbus</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shapes/columbus.gpkg"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading layer `columbus' from data source </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `/home/rsb/lib/r_libs/spData/shapes/columbus.gpkg' using driver `GPKG'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 49 features and 20 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: Undefined Cartesian SRS with unknown unit</span>
<span class="r-in"><span><span class="va">col.gal.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="read.gal.html">read.gal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"weights/columbus.gal"</span>, package<span class="op">=</span><span class="st">"spData"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">col.listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">col.gal.nb</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">columbus</span><span class="op">$</span><span class="va">fEW</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">columbus</span><span class="op">$</span><span class="va">EW</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">columbus</span><span class="op">$</span><span class="va">fDISCBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">columbus</span><span class="op">$</span><span class="va">DISCBD</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span>, <span class="fl">3</span>, <span class="fl">4.5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">CRIME</span><span class="op">)</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span> <span class="op">+</span> <span class="va">fDISCBD</span> <span class="op">+</span> <span class="va">fEW</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lm_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">f</span>, data<span class="op">=</span><span class="va">columbus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">lm_obj</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score (a.k.a Lagrange multiplier) diagnostics for spatial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	dependence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = f, data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          statistic parameter p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RSerr     1.915043         1  0.1664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RSlag     1.827463         1  0.1764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjRSerr  0.143411         1  0.7049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjRSlag  0.055831         1  0.8132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SARMA     1.970874         2  0.3733</span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_obj</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"SDM"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>use of spatially lagged factors (categorical variables)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD, fEW</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is not well-understood</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In addition variable:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is ordered (ordinal) with polynomial contrasts.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = f, data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSlag       1.8275         1  0.1764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSlag    1.9150         1  0.1664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSWX        3.6798         6  0.7199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSWX     3.7673         6  0.7081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_Joint       5.5948         7  0.5878</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDM_Joint</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDM_RSlag</span><span class="op">$</span><span class="va">statistic</span> <span class="op">+</span> <span class="va">res</span><span class="op">$</span><span class="va">SDM_adjRSWX</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDM_Joint</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDM_adjRSlag</span><span class="op">$</span><span class="va">statistic</span> <span class="op">+</span> <span class="va">res</span><span class="op">$</span><span class="va">SDM_RSWX</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_obj</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"SDEM"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>use of spatially lagged factors (categorical variables)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD, fEW</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is not well-understood</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In addition variable:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is ordered (ordinal) with polynomial contrasts.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = f, data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            statistic parameter p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSerr    1.9150         1  0.1664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSWX     3.6798         6  0.7199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_Joint    5.5948         7  0.5878</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDEM_Joint</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">SDEM_RSerr</span><span class="op">$</span><span class="va">statistic</span> <span class="op">+</span> <span class="va">res</span><span class="op">$</span><span class="va">SDEM_RSWX</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_obj</span>, <span class="fu"><a href="nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">col.gal.nb</span>, style<span class="op">=</span><span class="st">"C"</span><span class="op">)</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Spatial weights matrix not row standardized</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>use of spatially lagged factors (categorical variables)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD, fEW</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is not well-understood</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In addition variable:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> fDISCBD</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> is ordered (ordinal) with polynomial contrasts.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = f, data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: nb2listw(col.gal.nb, style = "C")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter p.value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSlag       3.0731         1 0.07960 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSlag    3.0436         1 0.08106 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSWX        7.0092         7 0.42792  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSWX     6.9797         7 0.43100  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_Joint      10.0528         8 0.26134  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSerr      3.0436         1 0.08106 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSWX       7.0092         7 0.42792  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_Joint     10.0528         8 0.26134  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_obj</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"all"</span>, Durbin<span class="op">=</span> <span class="op">~</span> <span class="va">INC</span>, data<span class="op">=</span><span class="va">columbus</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = f, data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Durbin: ~ INC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSlag     1.827463         1  0.1764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSlag  1.816700         1  0.1777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSWX      0.048043         1  0.8265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSWX   0.037280         1  0.8469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_Joint     1.864743         2  0.3936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSerr    1.915043         1  0.1664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSWX     0.048043         1  0.8265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_Joint    1.963086         2  0.3747</span>
<span class="r-in"><span><span class="va">lm_obj0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">CRIME</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">INC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">HOVAL</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> data<span class="op">=</span><span class="va">columbus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_obj0</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = I(scale(CRIME)) ~ 0 + I(scale(INC)) +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(scale(HOVAL)), data = columbus)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter  p.value   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSlag       7.8250         1 0.005153 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSlag    4.6111         1 0.031765 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSWX        6.0609         2 0.048295 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSWX     2.8470         2 0.240873   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_Joint      10.6720         3 0.013638 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSerr      4.6111         1 0.031765 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSWX       6.0609         2 0.048295 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_Joint     10.6720         3 0.013638 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="va">columbusNA</span> <span class="op">&lt;-</span> <span class="va">columbus</span></span></span>
<span class="r-in"><span><span class="va">columbusNA</span><span class="op">$</span><span class="va">HOVAL</span><span class="op">[</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">lm_objNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">CRIME</span> <span class="op">~</span> <span class="va">INC</span> <span class="op">+</span> <span class="va">HOVAL</span>, data<span class="op">=</span><span class="va">columbusNA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">SD.RStests</span><span class="op">(</span><span class="va">lm_objNA</span>, <span class="va">col.listw</span>, test<span class="op">=</span><span class="st">"all"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rao's score test spatial Durbin diagnostics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model: lm(formula = CRIME ~ INC + HOVAL, data = columbusNA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> weights: col.listw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              statistic parameter  p.value   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSlag       7.6010         1 0.005834 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSlag    4.4716         1 0.034463 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_RSWX        6.0812         2 0.047807 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_adjRSWX     2.9518         2 0.228576   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDM_Joint      10.5527         3 0.014407 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSerr      4.4716         1 0.034463 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_RSWX       6.0812         2 0.047807 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SDEM_Joint     10.5527         3 0.014407 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

